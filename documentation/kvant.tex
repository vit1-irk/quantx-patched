\documentclass[12pt]{article}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{pscyr}
\usepackage[a4paper,inner=2cm,outer=6cm,top=3cm,bottom=3cm]{geometry}
\usepackage[dvipsnames]{xcolor}
\usepackage{euler}
\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=OliveGreen,
  pdfstartview=FitH
}

\renewcommand{\Re}{\mathop{\mathrm{Re}}\nolimits}
\renewcommand{\Im}{\mathop{\mathrm{Im}}\nolimits}

\begin{document}
\hafamily
\tableofcontents

\section*{Инструкция по управлению программой Квант}

\hypertarget{start}{}\section{Быстрый старт--основное окно графического управления: потенциал и уровни энергии}
Запускаем kvant.exe.
Открывается окно, разворачиваем его во весь экран, в графической форме видим основные величины-- $U(x)$ (прямоугольную яму, заданную по умолчанию) и вычисленные для этого случая уровни энергии $E_n$ (горизонтальные сплошные линии). 
%Можно задать номер уровня $n$
%в текстовой строчке ниже графического окна и рядом увидеть энергию для данного $n$.

Автоматический быстрый пересчет $E_n$ при изменении $U(x)$-- одна из главных возможностей программы. Проверяем ее, двигая мышкой дно, правую границу или горизонтальную полуось слева от ямы. Менять $U(x)$ можно весьма произвольно.\footnote[1]{Если дошли до границы экрана, то масштабы можно изменить через контекстное меню Scales -- доступ к нему появляется при нажатии правой кнопки мыши, когда курсор находится в графическом окне.}$^,$ \footnote[2]{Если вы хотите точно задать ширины и $U$ на отрезках постоянства потенциала, то этой цели служит одно из основных меню программы --<<Потенциалы>>, пункт <<Табличный>>.} $^,$ \footnote[3]{Если вас не устраивает имеющееся число отрезков постоянства $U(x)$, то, подойдя курсором к любому, кроме полубесконечных, можно правой кнопкой мыши вызвать контекстное меню отрезка, расщепить его на два или удалить, и далее менять новый $U(x)$ графически или таблично.} 
 

Над потолком ямы зеленым пунктиром показан бегунок энергий. Его можно двигать мышкой, либо запустить автоматическое сканирование кнопкой с зеленым треугольником. Повторное нажатие остановит сканирование. Параметры автоматического сканирования управляемы.\footnote[4]{Начальное значение $E$ можно задать числом в строке под графиком U(x).  Шаг и интервал сканирования задаются через меню Energy range, которое содержится в контекстном меню графического окна $U(x)$.} Важно, что для любой текущей энергии решается уравнение Шредингера. Это позволяет быстро \hyperlink{psinx_psix} {прояснить процедуру поиска $E_n$}, просмотреть \hyperlink{psixE} {волновые функции в непрерывном спектре}
 и/или зависимости $N(E)$, $T(E)$ \hyperlink{zerosOfPsin}{--числа нулей волновой функции} и \hyperlink{PsiandTE} {коэффициента прохождения},
когда открыты соответствующие \hyperlink{menu2} {окна}.
 

\hypertarget{menu1}{}\section{Общие меню и инструменты}
Над графиками под заголовком программы находится строка
основных меню. В первую очередь нам интересны <<Потенциалы>> и  <<Зависимости>>.
Третья сверху строка -- панель инструментов с важными  
кнопками  
задания потенциала <<Un>> из одинаковых ям/барьеров и контроля значений насчитанных уровней <<En>>.

\hypertarget{menu2}{}\section{Варианты счета, окна и контекстные меню}
Варианты счета выбираются в меню <<Зависимости>>, при этом открывается новое
окно, которое при желании можно закрыть нажатием на красный крестик в нижнем углу окна. Очистить окно от прежних графиков можно нажатием на клавиатуре
клавиши "del". Некоторые окна (\hyperlink{PsiandTE}{$T(E)$}, \hyperlink{psixt}{$\psi(x,t)$}, \hyperlink{Uz}{$E_n(z)$})  появляются пустыми и требуется 
нажать кнопку с зеленым треугольником (<<поехали>>) чтобы начались расчет и построение. 

 Масштабы и дополнительные параметры,
такие как номера уровней, параметры волнового пакета, можно задать в
контекст\-но-зависящем меню, которое открывается при нажатии на правую кнопку
мышки в поле графического окна. Контекстные меню желательно чаще закрывать, чтобы не путаться между ними и не загромождать экран.
%Там же имеется <<Help>> и задания (<<Tasks>>).
%Пояснения к данному варианту счета можно получить при нажатии комбинации клавиш
%Ctrl-H, текст заданий -- Ctrl-T.
%Потенциал меняется мышкой в окне <<$U(x) \& E_n$>> или
%задается численно через пункт <<Табличный>> в меню <<Потенциалы>> или на панели инструментов кнопкой <<Un>>.
%которая запрашивает потенциал из одинаковых ям или барьеров. Таблица уровней
%открывается при нажатии кнопки <<En>>.

\hypertarget{main_model}{}\section{Основная модель}
По умолчанию установлена модель Bound states/Scattering.  В этой основной модели
решается стационарное уравнение Шредингера с граничными условиями
экспоненциального затухания волновой функции на $-\infty$ %минус бесконечности
при $E<U$ при $x<0$,
либо бегущей туда волны $e^{-ikx}$ при $E>U$ $(x<0)$ и $E>0$, что соответствует прохождению
плоской волны, падающей на потенциал из $+\infty$. %плюс бесконечности.
Состояния дискретного спектра
находятся из дополнительного условия \hyperlink{psinx_psix} {зануления волновой функции}
на $+\infty$ %плюс бесконечности
при некоторых энергиях $E_n<U(x<0)$  и $E_n<0$.
В данной модели в крайней правой области потенциал предполагается нулевым,
и при любой $E>0$ волновая функция в этой области \hyperlink{psixE} {имеет вид $A\exp(ikx)+B\exp(-ikx)$}.
Коэффициент отражения $R$ есть $|A/B|^2$, а \hyperlink{PsiandTE} {коэффициент прохождения} $T=1-R$.
В этой же модели из найденных стационарных состояний дискретного, либо
непрерывного спектра может быть собран \hyperlink{psixt} {волновой пакет}.

%Если не понятно, прочитайте \hyperlink{start}{этот параграф} снова.






\hypertarget{psinx}{}\section[Визуализация волновых функций]{Визуализация $\Psi_n(x)$}
Второй пункт <<$\psi_n(x)$>> меню <<Зависимости>> открывает окно координатных распределений.
Волновые функции связанных состояний показаны теми же цветами, что и уровни энергии в окне потенциала.
Горизонтальные координаты такие же, как в окне графического определения потенциала, чтобы было
понятно расположение особенностей волновых функций относительно особенностей в $U(x)$. 

Контекстное меню варианта <<$\psi_n(x)$>> позволяет выбирать номера уровней для рассмотрения. 
Очистить окно от прежних графиков $\psi(x)$ можно нажатием на клавиатуре
клавиши "del". Пересчитать и нарисовать уровневые функции можно кнопкой <<зеленый треугольник>>.

\hypertarget{psinx_psix}{}\section[Прояснение процедуры поиска уровней]{Прояснение процедуры поиска $E_n$ визуализацией $\Psi(x)$ с варьированием $E$}
Если в окне $U(x)\&En$ мышкой тронуть бегунок энергии $E$, то в окне $\psi_n(x)$ появится дополнительная волновая функция,
отвечающая этой переменной энергии. 
Для понимания отличия 
дискретных уровней от состояний при произвольной $E<0$ полезно посмотреть на графиках $Re \Psi (x)$ и $|\Psi(x)|^2$, как меняется волновая функция при прохождении
энергии через уровень (виляние хвостиком). Заметим, что под  графическим окном волновых функций есть строка, позволяющая выбор их представления. 

Чтобы наглядно представить себе связь состояний дискретного спектра с потенциалом, полезно следить
за деформацией волновых функций, когда $U(x)$ меняется непрерывно вручную, например, сужением или
обмелением ямы.  
\hypertarget{ErasePsin}{}\section{Отмена изображения уровневых функций}
Если через контекстное меню варианта <<$\psi_n(x)$>> в качестве номера уровней задать
хотя бы одно отрицательное значение, то можно рассматривать  функцию с варьируемой энергией
без изображения уровневых функций. 

\hypertarget{psixE}{}\section[Волновые функции в непрерывном спектре]{Волновые функции в непрерывном спектре}
Чтобы прояснить смысл непрерывного спектра энергий,
его важное отличие от дискретного спектра, а также смысл состояний стационарного рассеяния полезно
переместить бегунок энергий в область положительных энергий и непрерывно менять энергию, следя за
деформируемым координатным распределением, действительной или мнимой частью волновой функции. Можно увидеть более сложную, но наглядную картину 3D:$\Psi(x)$--кривую в координатах $Re\Psi$, $Im\Psi$, $x$. Выбор представления производится в строке под графическим окном. 
\hypertarget{ScaleChanged}{}\section{Изменение масштабов стрелками}
Координатное распределение своими интересными особенностями (горизонтальной полкой в
области прохождения и крупными осцилляциями в области отражения) может выходить за границы окна,
тогда без изменения физических масштабов можно переместить потенциал и соединенное с ним координатное
распределение вправо-влево простым нажатием соответствующей клавиши-стрелки на клавиатуре, аналогично
можно смещать распределение вверх-вниз.


\hypertarget{zerosOfPsin}{}\section [Число нулей волновой функции]{Число нулей  волновой функции при $E<\min(U(x=\pm\infty))$}
Для лучшего понимания процедуры поиска связанных состояний и особенностей в
непрерывном спектре полезно, выбором пункта <<$T(E)$>> в меню <<Зависимости>>,
открыть окно, которое одновременно предназначено для показа двух графиков.
Энергия в данном окне откладывается по горизонтали. 

При отрицательных энергиях в случае $U(x<0)\ge0$, или когда $E<U(x<0)<0$ 
изображается ступенчатая зависимость $N(E)$ -- полного числа нулей $\psi(x)$
(за исключением того, что установлен руками на $-\infty$).
В промежутке $U(x<0)<E<0$ это число принудительно зануляется, чтобы подчеркнуть отсутствие здесь уровней. 

Полезно бегунком энергии (в окне <<$T(E)$>>он изображается вертикальной линией)
исследовать переходы между соседними плато на  этой ступенчатой линии, следя
сразу за тремя окнами и, особенно, за тем, как меняется волновая функция
при изменении энергии.

\hypertarget{PsiandTE}{}\section[Коэффициент прохождения]{Коэффициент прохождения $T(E)$}
При $E>0$ в графическом окне <<$T(E)$>> изображается коэффициент прохождения.
Чтобы лучше понять смысл резонансов (пиков) полного прохождения в случае простых
симметричных $U(x)$ (одной прямоугольной ямы, барьера) полезно бегунком энергии
находить в непрерывном спектре состояния с $T=1$ и следить за изменением фазы
осцилляций $|\psi(x)|^2$ в области отражения.
Под графическим окном <<$T(E)$>>имеется кнопка запуска расчетов (слева) и кнопка <<Erase>> справа.
Первую можно применить, если изображение отсутствует, например, после удаления клавишей <<Delete>>,
вторую использовать для изображения семейства соответствующих кривых, если отменить стирание
(птичку в квадратике <<Erase>>).
\hypertarget{phin}{}\section{Импульсные распределения}
Окно импульсного распределения $|\phi_n(k)|^2$ подчиненно 
\hyperlink{psinx}{координатному}: выбор номеров уровней происходит
в окне координатных распределений. Масштабы задаются в контекстном меню.
%\hypertarget{phin_psin}{}\section{Вопросы: Координатные и импульсные распределения}
Полезно мышкой в графическом окне потенциала менять ширину ямы и следить за тем, как меняется вид импульсных и
координатных распределений. Особенно интересны моменты появления новых уровней.
Можно одновременно следить за трансформацией коэффициента прохождения T(E), если открыто соответствующее окно.
%Как и почему именно так выглядят импульсные распределения для узкой и широкой прямоугольной ямы.
\hypertarget{psixt}{}\section{Временная эволюция волнового пакета}
Две последние возможности в меню <<Зависимости>> касаются временной эволюции суперпозиции стационарных состояний
в координатном и импульсном представлении. Внешний вид окон такой же, как в случае стационарных распределений.
Масштабы задаются так же. Знакомство с пакетом необходимо начинать открытием соответствующего окна координатных
распределений <<$\Psi(x,t)$>>, в котором можно наблюдать результат смешивания дискретных состояний, либо имитировать волновой пакет,
собранный в непрерывном спектре из эквидистантных  энергий. Обе возможности открываются в данном окне так же,
как масштабы через контекстные меню. Веса гармоник распределены в виде гауссовской функции (по энергии в непрерывном
спектре, либо по номерам уровней в дискретном спектре).

%\hypertarget{TaskPsixt}{}\section{Задания: волновой пакет}
Знакомство с временной эволюцией состояний дискретного спектра лучше начинать с не очень широкой прямоугольной ямы,
например, заданной по умолчанию. Полезно прерывать движение, нажатием на клавишу ос\-та\-нов\-ки/во\-з\-об\-нов\-ле\-ния расчетов,
чтобы изменить, например, шаг по времени (пункт <<ht>> в меню <<time parame\-ters>> контекстного меню).
Для прерывания расчетов под графическим окном предусмотрена кнопка останова (зеленый треугольник кнопки запуска
расчетов меняется в ходе расчетов на кнопку с двумя шпалами, приглашающую прервать расчет). Расчеты будут быстрее,
если увеличить шаг по $x$ и шаг по времени.

При изучении временной эволюции суперпозиции связанных состояний откройте два окна $\Psi(x,t)$ и $|\Phi_n(k,t)|^2$.
Запуск и формирование суперпозиции идет через первое окно. В случае широкой ямы полезно сравнивать знак среднего
импульса с положением и направлением движения пакета в координатном представлении.

Наблюдение эволюции в непрерывном спектре требует резко расширить интервал наблюдения по $x$, чтобы видеть, как
пакет подходит к яме и рассеивается на ней. При этом лучше увеличить шаг по $x$, чтобы сократить время расчета
волновых функций. Полезно прерывать движение, как в предыдущем пункте, например, чтобы лучше разглядеть момент
столкновения пакета с ямой. Можно повторять рассмотрение с самого начала, если в табличке задания <<time parame\-ters>>
вернуть текущее время <<time>> к начальной нулевой точке.
Полезно сравнить рассмотренную по предыдущему пункту динамику с однонаправленным движением пакета из тех же
гармоник в свободном пространстве (глубину ямы сделать нулевой и вернуть время к начальной точке).
Интересно наблюдать медленное расплывание волнового пакета, а при рассмотрении $Re \Psi(x,t)$ увидеть различие
фазовой и групповой скорости –- опережение движения огибающей по сравнению с перемещением частых осцилляций внутри огибающей.
Расчет импульсного распределения в непрерывном спектре отсутствует.

\hypertarget{Uz}{}\section{Автоматическая деформация потенциала}
Автоматическая деформация потенциала производится после определения начального $U_1$ и конечного $U_2$ потенциалов
на одинаковом числе интервалов (Например, начальная яма глубокая, а конечная -- мелкая).
Любой такой потенциал можно назначить начальным (нажатием кнопки <<U1>> на панели инструментов программы), а другой --
конечным (кнопкой <<U2>>). Промежуточные потенциалы на интервале $i$ $U_i$ и ширины отрезков $d_i$ являются линейными
функциями параметра $z$ ($0\le z\le 1$): $U_i=U_{1i} (1-z)+U_{2i}z$, $d_i=d_{1i} (1-z)+d_{2i}z$, $0\le i\le N$. Например,
по умолчанию $U1$ это широкая, а $U2$ -- очень узкая яма. В меню <<Доп.возможности>> предусмотрены варианты <<En(z)>>
и <<T(z)>>, открывающие окна, в которых строятся, соответственно, зависимость уровней энергии и коэффициента прохождения
от z. В этих окнах вертикальной пунктирной линией дается бегунок по $z$, позволяющий увидеть для интересных мест на
графике $E_n(z)$ соответствующий потенциал $U(x)$, волновые функции, импульсное распределение, $T(E)$, если открыты
соответствующие окна.

При некотором %достаточном
освоении вышеуказанных возможностей и понимании свойств многоямных (барьерных) потенциалов можно
избрать одно из двух направлений дальнейшего знакомства с программой -- периодический потенциал или
квазистационарные состояния.

\hypertarget{Uper}{}\section{Периодический потенциал и квазиимпульс}
Пункт <<Periodic>> из меню <<Model>> позволяет периодически распространить заданный потенциал на отрезке $(0,x_N)$
на всю действительную ось, чтобы изучать состояния зонного спектра. 

Периодичность потенциала ($U(x+a)=U(x)$) влечет существование при 
любой $E$ $\Psi$-функций, для которых выполняется условие 
квазипериодичности: $\Psi_E(x+a)=e^{i\alpha(E)}\Psi_E(x)$. 
Распространяющиеся решения (состояния разрешенных зон) отвечают
неразличимости $|\Psi(x+a)|^2$ и $|\Psi(x)|^2$, т.е. $\alpha$ имеет смысл угла  
на комплексной плоскости между векторами $\Psi(x+a)$ и $\Psi(x)$ для любого $x$. 
Принято считать, что  $-\pi\le\alpha\le\pi$.  В фиксированном периодическом 
потенциале $U(x)$ этот угол зависит только от $E$.

В пределе слабой модуляции потенциала ($U_{max}-U_{min}\to 0$) движение 
становится свободным, разрешенная зона занимает весь непрерывный спектр и 
распространяющееся решение принимает известный вид $\Psi=e^{ikx}$. 
Следовательно, $\alpha$ в этом пределе имеет элементарную связь с импульсом: 
$ka=\alpha+2\pi N$ (целое N позволяет менять k от -$\infty$ до +$\infty$). 
В связи с этим величину $q \equiv\alpha/a$ в данном частном и во всех 
остальных случаях называют квазиимпульсом. 

В рассмотренном пределе 
легко преобразовать известную зависимость 
$E=k^2$ в закон дисперсии $E=f(qa)$, т.е.  
<свернуть> всю параболу по $ka$ в интервал $-\pi\le qa\le\pi$
горизонтальным сдвигом кусков параболы из интервалов 
[$-\pi+2\pi N$,$\pi+2\pi N$] в область изменения $qa$. Функция
$E=f(qa)$ является многозначной (любому квазиимпульсу отвечает бесконечное счетное множество энергий). Частота с которой 
следуют ветви энергии зависит от величины периода $a$. В точках  $qa=\pi$,  $qa=-\pi$ и $qa=0$ (за исключением $ka=0$) скорость частицы dE/dq при одной $E$ имеет по два значения, но |dE/dq| одинаковы.     

В общем случае
квазиимпульс находится по заданной E численно в результате 
сшивки $\Psi$-функции в точках разрыва потенциала на одном периоде $U(x)$
и применения условия квазиперидичности $\Psi(x)$ к граничным точкам периода. В некоторых полосах энергий (запрещенных зонах) квазиимпульс перестает быть действительной величиной и, напротив,
$\Psi_E(x+a)=\lambda_E\Psi_E(x)$, где $\lambda_E$ действительная величина, точнее две величины: $\lambda_1\lambda_2=1$. Поэтому   решения неограниченно растут с ростом номера периода в соответствующем направлении. При отсутствие границы у периодического потенциала эти решения не имеют физического смысла. 
   


Изучение общего случая в программе для простоты необходимо начинать с потенциала на
отрезке $(0,x_N)$ в виде одной ямы, например, заданной по умолчанию. Заметим, что при выборе пункта <<Periodic>> автоматически
добавляет один отрезок нулевого потенциала справа к тому потенциалу, который задавался при работе с другими пунктами
меню <<Model>>.  В окне потенциала покажется столько ям и разделяющих барьеров, сколько разрешают масштабы по $x$,
которые регулируются обычным для данной программы образом. На фоне потенциала соответствующим цветом показаны
края разрешенных зон.

\hypertarget{band_edge}{}\section[Как вычисляются края зон]{Как вычисляются $E_n$--края зон}
Умножением $\Psi(x)$ на некоторое число $e^{i\gamma(E)}$ 
делаем волновую функцию на левом краю периода действительнозначной и считаем число нулей $N(E)$ на периоде 
для полученной $Re\Psi(x)$. С ростом $E$ это число растет единичными ступенями. Чтобы не делать лишнего окна данная зависимость строится в том же окне, что и $T(E)$, которая для периодического потенциала не имеет смысла. Энергии, отвечающие появлению нового нуля на периоде лежат строго в центре каждой разрешенной зоны, т.е. там, где $qa=1/2$. Вы можете в этом убедиться, если вместе с окном $N(E)$ будете смотреть закон дисперсии $E(qa)$ и воспользуетесь бегунком энергии.

Идя от центра каждой зоны вверх и вниз по энергии, легко найти оба ее края, т.е. точки с $qa=0$ и $qa=1$.
В программе это сделано экономично, и края $E_n$ находятся почти мгновенно вслед за деформацией потенциала.


\hypertarget{Psi_per}{}\section[Координатные и импульсные распределения в периодическом потенциале]{Распределения по $x$ и $k$ в периодическом потенциале}
Если открыть окно волновых функций <<$\psi_n(x)$>>, то в нем будут показаны волновые функции краев подзон.
Полезно по виду $Re \psi(x)$, $3D:\Psi(x)$ усмотреть, каким квазиимпульсам отвечает каждое состояние, обратить внимание на
число и положение нулей, увидеть основной и дополнительный периоды осцилляций.

Если  открыть окно импульсного распределения, в нем автоматически отобразятся теми же цветами края зон. Состояния здесь рисуются
со сдвигом по вертикали, поскольку импульс принимает эквидистантные значения с универсальным шагом для всех краев
зон (почему?). Найдите в этом представлении основной и дополнительный периоды осцилляций $Re \psi(x)$. Посмотрите
большой интервал по энергии и объясните попарную группировку импульсных распределений.

По прежнему, можно бегунком энергии, который имеется в графическом окне потенциала (зеленый пунктир), управлять
энергией, приближенно измерять $E$ и видеть соответствующую волновую функцию. Интересно пройтись внутри разрешенных
и запрещенных зон, чтобы  увидеть разницу в типе координатных распределений и волновых функций. Для этого можно
сузить масштаб по вертикали для потенциала, чтобы уменьшить шаг графического варьирования $E$. Полезно разглядеть
на графике $Re \psi(x)$ квазиимпульс. Как (и почему именно так) отражается непрерывное изменение энергии на
импульсном распределении. Где на графике импульсного распределения виден квазиимпульс?
Как соотносятся квазиимпульс и наиболее вероятный импульс?

Графическая модификация потенциала в этой модели производится также обычно, но управлять можно только потенциалом
на исходном $(0,x_N)$ и добавленном отрезках, и период (в программе обозначается буквой $a$) будет автоматически
поддерживаться неизменным. Полезно наблюдать трансформацию волновых функций краев зон при варьировании параметров
потенциала и разглядеть, как (и почему именно так) она отражается на высоте основных и дополнительных пиков
импульсного распределения. Изменить период потенциала и другие его параметры можно из численной таблицы потенциала,
либо из пункта <<Un>>.
\hypertarget{qaOfE}{}\section{Закон дисперсии}
Закон дисперсии, зависимость энергии от квазиимпульса <<E(qa)>>, находится в меню дополнительных зависимостей.
Если ее построить, то будет видно, каким квазиимпульсам отвечают состояния внутри разрешенных зон и как с энергией меняется средняя скорость частицы.


\hypertarget{Uz_per}{}\section{Деформация зонного спектра}
Если менять мышкой параметры потенциала из двух (нескольких) одинаковых ям на
периоде, то можно видеть трансформацию зонного спектра и закона дисперсии. Соответственно,
можно назначить начальный и конечный потенциалы, сформированные графически, либо таблично, и посмотреть
зависимость краев зон от $z$: $E_n(z)$. Полезно бегунком $z$ рассмотреть интересные моменты
на этой зависимости в окнах волновых функций и импульсного распределения.

\hypertarget{U_quasi}{}\section{Квазистационарные состояния}
Выбор пункта <<Quasistationary>> из меню <<Model>> вместо <<Bound states/Scatte\-ring>> означает, что для тех же
потенциалов с конечным числом отрезков, будет решаться задача на поиск и визуализацию квазистационарных
состояний. Это подразумевает, во-первых, такое же разделение переменных $x$ и $t$ в нестационарном
уравнении Шредингера, как в стационарном случае, т.е. представление волной функции в виде произведения
$\Psi(x,t)= \psi(x)\exp(-iE_ct)$, но энергия $E_c$ является не действительной, а комплексной $E_c=E+iG$.
Дополнительно к прежним решениям мы будем рассматривать "распадные" состояния, т.е. состояния в
нижней полуплоскости e, для которых $|\Psi(x,t)|^2$ убывает со временем. Чтобы не запутаться с
граничными условиями, рассмотрим сначала более ясный случай нулевого потенциала на $\pm\infty$ %бесконечностях.
Тогда задача при произвольной $E+iG$, $G<0$ решается по аналогии с задачей стационарного рассеяния.
При $x<0$ решение задается в виде уходящей волны $\psi(x)= \exp(-ikx)$. При $x>x_N$ получается
$\psi(x)=A\exp(ikx)+B\exp(-ikx)$, где $k^2=E+iG$ принадлежит нижней полуплоскости и корень из $E+iG$
извлекается так, что  $k=k_R+ik_I$ принадлежит четвертому квадранту, независимо от знака $E$ ($k_R >0$, $k_I<0$).
При $x<0$ получается $\exp(-k_R x)\exp(k_I x)$ -- бегущая влево волна нарастающей влево амплитуды.
Соответственно, при $x>x_N$ будем иметь $A\exp(i k_R x)\exp(-k_I x)+B\exp(-i k_R x)\exp(k_I x)$,
т.е. интерференцию убегающей вправо и падающей справа волн. В данном случае дискретные квазистационарные
состояния, по определению, отвечают отсутствию приходящих волн, т.е. формально такому же условию,
как при поиске дискретных стационарных состояний ($B=0$ на $N+1$-ом отрезке по $x$).
Важное отличие в том, что теперь коэффициент $B$ это комплексно-значная функция $\Re B+i\Im B$ комплексной переменной
$E+iG$, и нужно найти значения этой переменной, в которых зануляется функция, т.е. одновременно
обращаются в ноль $\Re B$ и $\Im B$. Можно ожидать, что множества точек $\Re B(E,G)=0$ и $\Im B(E,G)=0$ будут
одномерными областями на плоскости $(E,G)$ -- линиями, которые могут пересекаться только в изолированных друг от друга точках.

Этот общий подход к описанию рассеяния можно применить и к ранее изученному случаю $E<0$, $G=0$.
Но нужно понимать, что по обычным правилам (и в программе) корень из действительной отрицательной величины
извлекается с расположением результата в верхней, а не нижней полуплоскости.
Поэтому в приведенные выше общие выражения нужно подставить $k_R = 0$ и $k_I >0$. Например,
при $x<0$ получается  действительное решение $\psi(x)=\exp(k_Ix)$, которое остается действительным на всей оси $x$,
т.е. коэффициент B становится действительной величиной. Следовательно, мы возвращаемся к обычному выражению
для ? при произвольной $E<0$, и при правильной процедуре поиска нулей B на всей плоскости $E+iG$  должны найтись и
дискретные стационарные уровни. Очевидно, что при этом одна из интересующих нас линий $Im B(E,G)=0$ совпадает с полуосью
отрицательных действительных $E$ и достаточно находить ее пересечения с линиями $Re B(E,G)=0$.

\hypertarget{Bquasi}{}\section{Методы поиска нулей на комплексной плоскости}
В программе реализовано два метода  решения уравнения $B_{N+1}=0$ на комплексной плоскости.
Для начала полезно знакомиться с первым, как более наглядным и надежным. Он выполняется после вызова пункта
<<$B_{N+1}(E+iG)$>> и нажатия кнопки с зеленым треугольником ниже соответствующего графического окна.
При этом переменная $E+iG$ пробегает шагами $hE$, $hG$ по всей решетке внутренних точек некоторого
прямоугольника на плоскости $(E,G)$.  Границы четырех областей изображаются разными цветами:
1 -- $Re B>0$, $Im B>0$; 2-- $Re B>0$ , $Im B<0$, 3-- $Re B<0$, $Im B>0$, 4-- $Re B<0$, $Im B<0$. Следовательно,
линия $Im B=0$ лежит между границами областей 1-2 и, соответственно, 3-4, а линия $Re B=0$ проходит
между границами областей 1-3 и 2-4. Места встречи всех четырех областей указывают положение искомых точек
с точностью до размера прямоугoльничка $(hE,hG)$. В этих местах запускается алгоритм секущих, уточняющих
дискретные значения $E_n+iG_n$ итерациями: $e_{i+1}=e_i-B_i(e_i-e_{i-1})/(B_i-B_{i-1})$, где $e=E+iG$, $e_0$ и $e_1$--
противоположные вершины трехцветного малого ромба. Их выбор не однозначен, но, по опыту, результат применения
алгоритма секущих получается одинаковым. Найденные $E_n+iG_n$ складываются в таблицу, вызываемую на экран пунктом
<<En+iGn>>. Заметим, что $hE$, $hG$ и границы большого прямоугольника заданы по умолчанию, и могут быть
переопределены из контекстных меню, открываемых правой кнопкой мыши.

Этот общий метод находит дискретные значения и на полуоси отрицательных действительных энергий,
если задать $G_{\max}>0$ и $E_{min}=U_{\min}$. Поведение границ областей 1,2,3,4 по разные стороны этой оси является странным
и не столь ясным, как при $G<0$ (почему?). В связи с этим, полезно по таблицам энергий и по виду волновых функций
проверить совпадение найденных на оси состояний с обычными уровнями энергии в том же потенциале.

Альтернативный метод поиска дискретных состояний при $G<0$ является более быстрым, поскольку для него
предварительное сканирование проводится лишь по $E$ при фиксированном малом отрицательном $G$. При этом, как можно
понять из предыдущей полной картины, бегунок $E$ последовательно и поочередно встречает линии $Im B=0$ и  $Re B=0$.
Пары точек изменения знака $Im B$ (либо $Re B$) считаются точками $e_0$ и $e_1$ запуска алгоритма секущих.
Любой из этих стартов, в случае сходимости алгоритма секущих, находит лишь правильные точки $B=0$, как и в
первом методе. Из-за сложного рельефа функции $B(e)$ и большой дистанции  до искомой точки (неудачных значений $e_0$, $e_1$),
второй метод может промахиваться (расходиться или циклить), и тогда итерации автоматически прерываются. Однако,
несмотря на некоторые пропуски состояний, этот быстрый метод автоматически применяется, как только  выбирается
пункт <<Quasistationary>> из меню <<Model>>, либо переопределяется потенциал. В результате, на фоне потенциала
соответствующим цветом рисуются горизонтальные линии $E_n$ для найденных $E_n+iG_n$, а сами комплексные числа
складываются в таблицу, вызываемую пунктом <<En+iGn>>. Если ранее было открыто окно с прямоугольником $(E,G)$,
то в нем эти точки автоматически располагаются со стиранием прежнего изображения. Полезно следить за изменением
положения этих точек при изменении потенциала мышью.
На самом деле, дискретные квазистационарные состояния можно считать уширенными уровнями энергии с шириной,
определяемой $G_n$. Соответствующее распределение по действительным энергиям частицы дается формулой
Брейта-Вигнера: $W(E)=1/(1+(E-E_n)^2/G^2)$.

\hypertarget{BW}{}\section{Контуры Брейта-Вигнера}
Для удобства контуры Брейта-Вигнера можно нарисовать в окне $T(E)$. По умолчанию рисуется найденное
состояние с наименьшей $E_0$ при $G<0$. Полезно расширять одну яму и видеть, как это состояние появляется
при положительных $E_n$, но исчезает при малых отрицательных, но хвост распределения $W(E)$ все еще виден при $E>0$.
Интересно, что вид волновой функции квазистационарного состояния $\psi_n(x)$ почти не меняется, когда $E_n$
проходит через ноль. Состояние было и остается в обе стороны от нуля  распадным, что видно по квадрату модуля.
Можно считать, что это <<странное>> поведение есть результат присутствия существенной части энергий из
распределения Брейта-Вигнера в области $E>0$.

\hypertarget{WPquasi}{}\section{Зависимость от времени квазистационарных состояний}
Если открыть окно волнового пакета в координатном представлении, то можно посмотреть за временной
эволюцией одиночного квазистационарного состояния, либо их суперпозиции (то и другое заказывается по номерам n)
через выбор соответствующего контекстного меню, нажатием правой кнопки мыши. Интересно смотреть не только
квадрат модуля, но также эволюцию реальной части волновой функции. Интересно понять, что и почему
произойдет с $Re \Psi_n(x,t)$, если $E_n$ изменит знак при небольшом изменении потенциала.
Просто и интересно выглядят квазистационарные состояния в случае, аналогичном резонансному
туннелированию через пару или несколько одинаковых барьеров.

\hypertarget{Psiquasi}{}\section{Квазистационарные состояния в особых случаях}
Прежнее определение в смысле отсутствия приходящих волн легко обобщается и
сохраняется в силе для состояний на плоскости $(E,G)$, отвечающих значениям $E>\max(U(x<0),0)$, либо $E<\min(U(x<0),0)$.
В первом случае имеется распад в обе стороны и квадрат модуля растет быстрее в сторону большего потенциала
(почему?). Во втором случае мы имеем дело с обычными уровнями, для которых ситуация с квадратом модуля
противоположна.

Вопрос о граничных условиях при поиске квазистационарных состояний не прост  в случае %промежуточных энергий
$\min(U_l,0)<E<\max(U_l,0)$, где $U_l=U(x<0)$. Глубоко внутри этой области энергий ширина квазистационарных дискретных
уровней будет много меньше, чем $\max(U_l,0)-E_n$. Лишь малая доля частиц из распределения Брейта-Вигнера
будет иметь действительную энергию выше, чем $\max(U_l,0)-E_n$. Поэтому кажется разумным формально запретить
распад в  потенциальную ступень, поскольку по физике он вряд ли возможен при большой величине $\max(U_l,0)-E$.
Например, так делается в случае потенциала с бесконечной стенкой, на которой $\psi(x=0)=0$, и распад идет в
одну сторону. Тогда при конечной, но высокой ступени можно считать, что при $G<0$ "волна втягивается" из ступени,
чтобы  затем уйти в том же направлении на другую бесконечность. Если при этом $U_l>0$, то при $x<0$,
волновая функция задается в виде приходящей волны $\exp(ik_0x)$, $k_0=k_{0R}+ik_{0I}$ ($k_{0R}>0$, $k_{0I}<0$),
т.е. $\psi(x)=\exp(ik_{0R}x)\exp(-k_{0I}x)$. На другой стороне однако вид волновой функции такой же, как раньше
и поиск квазистационарных состояний это поиск нулей функции $B(E+iG)$. Если, наоборот, $U_l<0$ и $E<0$, то
граничные условия меняются на противоположные. Из $+\infty$ %плюс бесконечности
идет только приходящая волна $B\exp(-ik_Rx)\exp(k_Ix)$,
 но зато при $x<0$ волновая функция в задаче рассеяния при комплексной энергии имеет общий вид
$A_0\exp(ik_{0R}x)\exp(-k_{0I}x)+B_0\exp(-ik_{0R}x)\exp(k_{0I}x)$. Следовательно, поиск дискретных
квазистационарных состояний ведется по условию $A0=0$. К сожалению, трудно четко определить, какая ступень
является достаточно высокой, чтобы менять гранусловия, как сказано в этом пункте. Поэтому мы меняли их
просто по формальному условию попадания в окно энергий $\min(U_l,0)<E<\max(U_l,0)$.
При этом для некоторых потенциалов будет потеряно состояние, которое только что опустилось под $\max(U_l,0)$
и является распадным в обе стороны из-за конечной ширины распределения Брейта-Вигнера.
Поскольку эти потери случаются редко и суть потерь ясна, в программе мы их не отслеживаем.

\hypertarget{File}{}\section{Запись и чтение файлов}
Меню <<File>> содержит пункты  выхода из программы, чтения из файла, записи в файл
и пункт краткого пояснения к программе Kvant.
Можно воспользоваться файлами данных на этапе первоначального знакомства с программой или
для быстрых демонстраций на лекциях и семинарах без использования продвинутых возможностей
интерактивного управления.

\end{document}
