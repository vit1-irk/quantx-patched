\documentclass{article}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{hyperref}
\usepackage{literat}

\begin{document}
\tableofcontents

Инструкция по интерактивному графическому управлению программой Квант.

Запускаем kvant.exe. 
Открывается окно, сверху - снизу видны текстовые поля, а в центре графическое окно. Три верхние текстовые строчки универсальны. В синей верхней строке помещен заголовок программы "Решение уравнения Шредингера с кусочно-постоянным потенциалом". Три кнопки обычного вида на другом краю строки стандартно реагируют на мышку – сворачивают, расширяют текстово-графическое окно программы на весь экран или выгружают программу kvant.  

Во второй строке видим заголовки основных меню:  "File", "Потенциалы", "Зависимости", "Доп. зависимости". Третья строка –панель инструментов. Она начинается с кнопки "Model", которая позволяет выбрать граничные условия,  далее следуют кнопки задания потенциала и просмотра энергий насчитанных уровней.

По умолчанию установлена модель "Bound states/Scattering".  В этой модели решается стационарное уравнение Шредингера с гранусловиями  экспоненциального затухания волновой функции на минус бесконечности при E<U(x<0), либо бегущей туда волны exp(-ikx) при E>U(x<0) и E>0 (непрерывный спектр, есть приходящая из плюс бесконечности волна). Состояния дискретного спектра находятся из дополнительного условия зануления волновой функции на плюс бесконечности при некоторых энергиях En<U(x<0) и En<0. В данной модели в крайней правой области потенциал предполагается нулевым, и при любой E>0 волновая функция в этой области имеет вид Aexp(ikx)+Bexp(-ikx). Коэффициент отражения R есть |A/B|2, а коэффициент прохождения T=1-R. В этой же модели из найденных стационарных состояний дискретного, либо непрерывного спектра может быть собран волновой пакет. 

\section
1.	  Все параметры в программе заданы по умолчанию, они соответствуют сравнительно простым физическим задачам по соответствующим темам. Так, установлен потенциал из одной ямы и первый пункт меню "Зависимости", а именно, "U(x)&En"– просмотр и задание потенциала и дискретных уровней энергии. Соответственно, открыто одно графическое окно. Работа с программой начинается в этом окне, поскольку оно позволяет изменять потенциал и энергию с помощью мышки. Численные значения параметров потенциала контролируемы из меню "Потенциалы" (пункт "Табличный"). Найденные уровни отображаются в таблице уровней "En" (см. через вызов в панели инструментов) и разноцветными горизонтальными линиями на фоне потенциала. 
\section
2.	Чуть выше потолка ямы (по умолчанию задано E=0.1) есть также пунктирная (зеленая) горизонталь. Она изображает свободно и непрерывно меняемую энергию E в уравнении Шредингера. Решение, соответствующее этой энергии, использует гранусловие лишь на минус бесконечности. Значение энергии можно видеть в текстовой строчке ниже графического окна. Если его отредактировать, оставляя положительным, или сделать отрицательным, то (после нажатия клавиши "Enter") положение пунктирной линии изменится. Линию энергии (бегунок энергии), в отличие от сплошных линий уровней, можно двигать вверх-вниз с помощью мышки. При совмещении этой линии с уровнями или горизонтальными полками потенциала можно видеть их примерные численные значения. Кроме числа E, выдается значение коэффициента прохождения T, если E>0, либо N–полного числа нулей волновой функции (без одного) при любой E<0. Можно на числах увидеть, что происходит с T при росте E, начиная с нуля, а также с N при изменении E<0, особенно вблизи En. 
\section
3.	  Подобно бегунку энергии, кусочно-постоянный потенциал можно менять мышкой, если его отрезки зацепить, что отображается изменением цвета отрезка и заменой сплошного отрезка на пунктирный. Зацепленный отрезок можно тащить– горизонтальный вверх-вниз (кроме крайнего справа, где U=0), а вертикальный отрезок вправо-влево (кроме крайнего слева, где x=0). При этом ломанная, изображающая потенциал, остается непрерывной. Изменения графика U(x) немедленно отражаются в таблице потенциала, доступной из меню "Потенциалы", а редактирование руками чисел в таблице передается графику U(x) (после изменения числа и нажатия клавиши "Enter", либо после возвращения курсора в графическое окно и нажатия левой кнопки мыши). Всякое изменение потенциала сразу вызывает пересчет дискретных уровней En, что видно из картины их положений, а также из таблицы En, если она открыта.      
По умолчанию в программе потенциал задан на двух отрезках, примыкаюших к точке x=0, т.е. имеется одна прямоугольная яма. Этот вариант, из которого легко получить потенциальную ступень или яму/барьер, примыкающие к ступени, является основным для аналитического решения уравнения Шредингера. Без его изучения, хотя бы  с нескольких точек зрения (пункты 1-17), бессмысленно задавать потенциалы более сложной формы. Тем не менее потенциал в программе можно легко усложнять либо численным заданием параметров (п.18), либо непосредственно в графическом окне (п.19) и аналитическое рассмотрение соответствующих задач станет трудным или невозможным. 

\hypertarget{ctx}{}\section{Контекстное меню}
4.	  Контекстное меню окна открывается правой кнопкой мыши при нажатии на пустую область графического окна. Оно позволяет задавать масштабы и диапазон энергии. Кнопка с зеленым треугольником (значком "вперед")  запускает автоматическое изменение энергии с шагом hE. Это позволяет быстро просмотреть волновые функции, когда открыто окно координатных распределений (см. следующий пункт). 
\section
5.	  Второй пункт "?n(x)" меню "Зависимости" открывает окно координатных распределений. Здесь кривыми соответствующего цвета показаны волновые функции дискретных уровней, о которых речь шла выше. Горизонтальные координаты такие же, как в окне графического определения потенциала, чтобы было понятно расположение особенностей волновых функций относительно особенностей в U(x). Если в верхнем графическом окне мышкой тронуть бегунок энергии E, то появится дополнительная волновая функция, отвечающая этой переменной энергии. Полезно посмотреть, как меняется волновая функция при прохождении энергии через уровень.
\section
6.	 Чтобы наглядно представить себе связь состояний дискретного спектра с потенциалом, полезно следить за деформацией волновых функций, когда U(x) меняется непрерывно вручную, например сужением или обмелением ямы. Вопрос на понимание: что и почему происходит с волновой функцией, когда U(x<0) резко увеличивается, или наоборот, приближается сверху к соответствующему уровню. Под  графическим окном волновых функций есть строка, позволяющая выбор их представления (реальная, мнимая части и квадрат модуля).  Полезно посмотреть, чем они отличаются. Чтобы прояснить смысл непрерывного спектра энергий, его важное отличие от дискретного спектра, а также смысл состояний стационарного рассеяния полезно переместить бегунок энергий в область положительных энергий и непрерывно менять его там, следя за деформируемым координатным распределением, действительной или мнимой частью волновой функции. 
\section
7.	  Координатное распределение своими интересными особенностями (горизонтальной полкой в области прохождения и крупными осцилляциями в области отражения) может выходить за границы окна, тогда без изменения физических масштабов можно переместить потенциал и соединенное с ним координатное распределение вправо-влево простым нажатием соответствующей клавиши-стрелки на клавиатуре, аналогично можно смещать распределение вверх-вниз. 
\section
8.	Контекстное меню (открываемое стандартно, как описано выше) позволяет задавать масштабы изображений или выбирать номера уровней для рассмотрения. Если в меню номера уровней задать хотя бы одно отрицательное значение, то можно рассматривать только функцию с варьируемой энергией без изображения уровневых функций. Очистить окно от прежних изображений можно нажатием на клавиатуре клавиши "del". Пересчитать и нарисовать уровневые функции можно кнопкой <<зеленый треугольник>>. Любое графическое окно можно закрыть нажатием на красный крестик в нижнем углу окна и потом открыть из меню "Зависимости".

Вопросы на понимание к этим упражнениям: почему при симметричном потенциале координатные распределения в дискретном спектре симметричны, а в непрерывном, как правило, асимметричны; почему в непрерывном спектре при x<0 в |?|2 имеем полку, а при x>xN осцилляции; почему они обычно растут и растягиваются при приближении E к нулю, что при этом происходит с коэффициентом прохождения; как и почему различаются фазы осцилляций реальной и мнимой части волновой функции при x<0; как (и почему именно так) выглядят координатные распределения для асимметричного потенциала, когда 0<Е<U(x<0), чему равен коэффициент прохождения; те же вопросы для редкого случая 0<Е=U(x<0); чем от этих случаев отличаются "экзотические варианты" U(x<0)<E<0, U(x<0)=E<0.

9.	Для лучшего понимания процедуры поиска связанных состояний и особенностей в непрерывном спектре полезно, выбором пункта "T(E)" в меню "Зависимости", открыть окно, которое одновременно предназначено для показа двух графиков. Энергия в данном окне откладывается по горизонтали. При отрицательных энергиях изображается ступенчатая зависимость N(E)–полного числа нулей ?(x) (за исключением того, что установлен руками на минус бесконечности). Полезно бегунком энергии (в данном окне он изображается вертикальной линией)  исследовать переходы между соседними плато на  этой ступенчатой линии, следя сразу за тремя окнами и, особенно, за тем, как меняется волновая функция при изменении энергии.
10.	При E>0 в графическом окне T(E) изображается коэффициент прохождения. Чтобы лучше понять смысл резонансов (пиков) полного прохождения в случае простых симметричных U(x) (одной прямоугольной ямы, барьера) полезно бегунком энергии находить в непрерывном спектре состояния с T=1 и следить за изменением фазы осцилляций |?(x)|2 в области отражения. 
11.	Как и почему меняется положение и ширина этих резонансов с изменением ширины ямы/барьера. Под этим графическим окном имеется кнопка запуска расчетов (слева) и кнопка "Erase" справа. Первую можно применить, если изображение отсутствует, например, после удаления клавишей "del", вторую использовать для изображения семейства соответствующих кривых, если отменить стирание (птичку в квадратике "Erase"). 
12.	Посмотрите импульсные распределения для стационарных связанных состояний |?(x)|2. Соответствующее окно раскрывается одноименным пунктом в меню "Зависимости". Окно импульсного распределения подчиненно координатному. Выбор номеров уровней происходит в окне координатных распределений. Полезно мышкой в графическом окне потенциала менять ширину ямы и следить за тем, как меняется вид импульсных и координатных распределений. Особенно интересны моменты появления новых уровней. Можно одновременно следить за трансформацией коэффициента прохождения T(E), если открыто соответствующее окно. Вопрос на понимание: как и почему именно так выглядят импульсные распределения для узкой и широкой прямоугольной ямы.
13.	Две последние возможности в меню "Зависимости" касаются временной эволюции суперпозиции стационарных состояний в координатном и импульсном представлении. Внешний вид окон такой же, как в случае стационарных распределений. Масштабы задаются так же. Знакомство с пакетом необходимо начинать открытием соответствующего окна координатных распределений, в котором можно наблюдать результат смешивания дискретных состояний, либо имитировать волновой пакет, собранный в непрерывном спектре из эквидистантных  энергий. Обе возможности открываются в данном окне так же, как масштабы через контекстные меню. Веса гармоник распределены в виде гауссовской функции (по энергии в непрерывном спектре, либо по номерам уровней в дискретном спектре). 
14.	Знакомство с временной эволюцией состояний дискретного спектра лучше начинать с не очень широкой прямоугольной ямы, например, заданной по умолчанию. Полезно прерывать движение, нажатием на клавишу остановки/возобновления расчетов, чтобы изменить, например, шаг по времени (пункт "ht" в меню "time parameters" контекстного меню). Для прерывания расчетов под графическим окном предусмотрена кнопка останова (зеленый треугольник кнопки запуска расчетов меняется в ходе расчетов на кнопку с двумя шпалами, приглашающую прервать расчет).
15.	Наблюдение эволюции в непрерывном спектре требует резко расширить интервал наблюдения по x, чтобы видеть, как пакет подходит к яме и рассеивается на ней. При этом лучше увеличить шаг по x, чтобы сократить время расчета волновых функций. Полезно прерывать движение, как в предыдущем пункте, например, чтобы лучше разглядеть момент столкновения пакета с ямой. Можно повторять рассмотрение с самого начала, если в табличке задания "time parameters" вернуть текущее время "time" к начальной нулевой точке.
16.	Полезно сравнить рассмотренную по предыдущему пункту динамику с однонаправленным движением пакета из тех же гармоник в свободном пространстве (глубину ямы сделать нулевой и вернуть время к начальной точке). Интересно наблюдать медленное расплывание волнового пакета, а при рассмотрении Re ?(x,t) увидеть различие фазовой и групповой скорости– отставание движения огибающей от перемещения частых осцилляций внутри огибающей. 
17.	При изучении временной эволюции суперпозиции связанных состояний к данному окну для ясности можно добавить через меню "Зависимости" окно временной эволюции в импульсном представлении, однако запуск и формирование суперпозиции идет через первое окно. В случае широкой ямы полезно сравнивать знак среднего импульса с положением и направлением движения пакета в координатном представлении.

После изучения случая простых потенциалов можно идти к случаям, которые трудно изучить с помощью формул. 

18.	 Рассмотрим вариант численного задания потенциала. Через пункт "Un", расположенный в текстовой строке над графическими окнами, можно задать потенциал из нескольких эквидистантных одинаковых прямоугольных ям/барьеров, который немедленно отображается графически. Случай двух таких объектов являются основным для понимания и полезно его изучить до задания более сложных потенциалов. Через меню "Потенциалы" можно добавить к ранее заданному потенциалу кусочно-постоянный "линейный" склон (в точке xN потенциал закреплен) или задать кусочно-постоянный "параболический" потенциал глубиной U0 с управляемым числом точек разбиения и длиной отрезка  (0,xN). При задании "линейного" потенциала автоматически устанавливается значение U(x<0); При задании "параболического" потенциала автоматически устанавливается U(x<0,x>xN)=0.
19.	Рассмотрим графический вариант усложнения формы потенциала. Можно разбить выбранный отрезок потенциала на два (кроме полубесконечных), нажав правую кнопку мышки и выбрав из подсказки пункт "Split here", а затем перетаскивая соседние горизонтальные и вертикальные отрезки, как сказано выше. Напротив, можно упрощать потенциал, удаляя выделенный горизонтальный отрезок (нажав правую кнопку мышки и выбрав из подсказки пункт "Remove segment"). Ломанная, изображающая потенциал, остается непрерывной. Появление, исчезновение отрезков потенциала сразу отражается в таблице потенциала, доступной через меню "Потенциалы". Можно подправлять параметры через эту таблицу, добиваясь точных численных значений. Заметим, что редактирование через "Un" немедленно заменит графически усложненный потенциал на другой (строго симметричный и с другими параметрами).

С постепенным усложнением потенциала (начиная с двух одинаковых ям) можно, по аналогии с п.1-18, наполнять универсальную модель "Bound states/Scattering" все новым содержанием. 

20.	Полезно обратиться (не с самого начала знакомства с программой) к вариантам с автоматической деформацией потенциала от начального до конечного без изменения числа отрезков задания потенциала N+1. Любой такой потенциал можно назначить начальным (нажатием кнопки U1 в панели инструментов программы), а другой– конечным (кнопкой U2). Промежуточные потенциалы Ui и ширины отрезков di являются линейными функциями параметра z (0?z?1): Ui=U1i (1-z)+U2iz, di=d1i (1-z)+d2iz, 0?i?N. Например, по умолчанию U1 это широкая, а U2-очень узкая яма. В меню "Доп.возможности" предусмотрены варианы "En(z)" и "T(z)", открывающие окна, в которых строятся, соответственно, зависимость уровней энергии и коэффициента прохождения  от z. В этих окнах вертикальной пунктирной линией дается бегунок по z, позволяющий увидеть для интересных мест на графике En(z) соответствующий потенциал U(x), волновые функции, импульсное распределение, T(E), если открыты соответствующие окна.

При достаточном освоении вышеуказанных возможностей и понимании свойств многоямных (барьерных) потенциалов можно избрать одно из двух направлений дальнейшего знакомства с программой (периодический потенциал–пункты 22-28, либо квазистационарные состояния–17-22). При первом обращении к ним необходимо вернуться к наиболее простым потенциалам на интервале (0,xN).
22.	Пункт "Periodic" из меню "Model" позволяет периодически распространить заданный потенциал на отрезке (0,xN) на всю действительную ось, чтобы изучать состояния зонного спектра. Для простоты необходимо начинать с потенциала на отрезке (0,xN) в виде одной ямы, например, заданной по умолчанию. Заметим, что выбор пункта "Periodic" автоматически добавляет один отрезок нулевого потенциала справа к тому потенциалу, который задавался при работе с другими пунктами меню "Model".  В окне потенциала покажется столько ям и разделяющих барьеров, сколько разрешают масштабы по x, которые регулируются обычным для данной программы образом. На фоне потенциала соответствующим цветом показаны края разрешенных зон.
23.	Если открыть окно волновых функций, то в нем будут теми же цветами показаны волновые функции этих краев (полезно по виду Re?(x) усмотреть, каким квазиимпульсам отвечает каждое состояние, обратить внимание на число и положение нулей, увидеть основной и дополнительный периоды осцилляций). Полезно затем открыть окно импульсного распределения, в нем автоматически отображаются теми же цветами края зон. Состояния здесь рисуются со сдвигом по вертикали, поскольку импульс принимает эквидистантные значения с универсальным шагом для всех краев зон (почему?). Найдите в этом представлении основной и дополнительный периоды осцилляций Re?(x). Посмотрите большой интервал по энергии и объясните попарную группировку импульсных распределений.
24.	По прежнему, можно бегунком энергии, который имеется в графическом окне потенциала (зеленый пунктир), управлять энергией, приближенно измерять E и видеть соответствующую волновую функцию. Интересно пройтись внутри разрешенных и запрещенных зон, чтобы  увидеть разницу в типе координатных распределений и волновых функций. Для этого можно сузить масштаб по вертикали для потенциала, чтобы уменьшить шаг графического варьирования E. Полезно разглядеть на графике Re?(x) квазиимпульс. Как (и почему именно так) отражается непрерывное изменение энергии на импульсном распределении. Где на графике импульсного распределения виден квазиимпульс? Как соотносятся квазиимпульс и наиболее вероятный импульс? 
25.	Графическая модификация потенциала в этой модели производится также обычно, но управлять можно только потенциалом на исходном (0,xN) и добавленном отрезках, и период (в программе обозначается буквой a) будет автоматически поддерживаться неизменным. Полезно наблюдать трансформацию волновых функций краев зон при варьировании параметров потенциала и разглядеть, как (и почему именно так) она отражается на высоте основных и дополнительных пиков импульсного распределения. Изменить период потенциала и другие его параметры можно из численной таблицы потенциала, либо из пункта "Un". 
26.	В данной модели имеется,  так называемый, закон дисперсии–зависимость квазиимпульса от энергии "qa(E)", которая вынесена в дополнительные, как редкая для программы в целом. Если ее построить, то будет легко видно, каким квазиимпульсам отвечают состояния в разрешенных зонах, и легко будет управлять бегунком энергии, если изменить в этом окне масштаб. Это важно для дальнейших упражнений и полезно при выполнении пунктов 22-25. Где на этом графике средняя скорость и эффективная масса частицы, как они меняются с ростом номера разрешенной зоны и внутри зон?
27.	Можно построить волновой пакет из состояний в разрешенной зоне и сопоставить направление движения  максимума |?|2 с номером зоны, направлением квазиимпульса, положением основного пика импульса и направлением средней скорости. 
28.	 Полезно с помощью "Un" задать вместо одной две (потом три) ямы на периоде и объяснить форму закона дисперсии, посмотреть, как изменится импульсное распределение для краев зоны и его поведение с изменением E внутри зон. Рассмотрите и объясните форму и движение волнового пакета, сформированного в таком же окне энергий, как для одной ямы на периоде. 
29.	Теперь можно графически менять любой параметр потенциала из двух (нескольких) одинаковых ям на периоде и наблюдать трансформацию зонного спектра, в том числе, на законе дисперсии. Соответственно, можно назначить начальный и конечный потенциалы, сформированные графически, либо таблично, и посмотреть En(z). Полезно бегунком z рассмотреть интересные моменты на этой зависимости с помощью волновых функций или импульсного распределения. 

Завершение знакомства с возможностями программы. 
Выбор пункта "Quasistationary" из меню "Model" вместо "Bound states/Scattering" означает, что для тех же потенциалов с конечным числом отрезков, будет решаться задача на поиск и визуализацию квазистационарных состояний. Это подразумевает, во-первых, такое же разделение переменных x и t в нестационарном уравнении Шредингера, как в стационарном случае, т.е. представление волной функции в виде произведения ?(x,t)= ?(x)exp(-iet), но энергия e является не действительной, а комплексной e=E+iG. Дополнительно к прежним решениям мы будем рассматривать "распадные" состояния, т.е. состояния в нижней полуплоскости e, для которых |?(x,t)|2 убывает со временем. Чтобы не запутаться с гранусловиями, рассмотрим сначала более ясный случай нулевого потенциала на бесконечностях. Тогда задача при произвольной E+iG, G<0 решается по аналогии с задачей стационарного рассеяния. При x<0 решение задается в виде уходящей волны ?(x)= exp(-ikx). При x>xN получается ?(x)=Aexp(ikx)+Bexp(-ikx), где k2=E+iG принадлежит нижней полуплоскости и корень из E+iG извлекается так, что  k=kR+ikI принадлежит четвертому квадранту, независимо от знака E (kR >0, kI<0). При x<0 получается exp(-kR x)exp(kI x)–бегущая влево волна нарастающей влево амплитуды. Соответственно, при x>xN будем иметь Aexp(i kR x)exp(-kI x)+Bexp(-i kR x)exp(kI x), т.е. интерференцию убегающей вправо и падающей справа волн. В данном случае дискретные квазистационарные состояния, по определению, отвечают отсутствию приходящих волн, т.е. формально такому же условию, как при поиске дискретных стационарных состояний (B=0 на N+1 отрезке по x). Важное отличие в том, что теперь коэффициент B это комплекснозначная функция ReB+iImB комплексной переменной E+iG, и нужно найти значения этой переменной, в которых зануляется функция, т.е. одновременно  обращаются в ноль ReB и ImB. Можно ожидать, что множества точек ReB(E,G)=0 и ImB(E,G)=0 будут одномерными областями на плоскости (E,G)-линиями, которые могут пересекаться только в изолированных друг от друга точках. 

Важное замечание. Этот общий подход к описанию рассеяния можно применить и к ранее изученному случаю E<0, G=0. Но нужно понимать, что по обычным правилам (и в программе) корень из действительной отрицательной величины извлекается с расположением результата в верхней, а не нижней полуплоскости. Поэтому в приведенные выше общие выражения нужно подставить kR =0 и kI >0. Например, при x<0 получается  действительное решение ?(x)=exp(kIx), которое остается действительным на всей оси x, т.е. коэффициент B становится действительной величиной. Следовательно, мы возвращаемся к обычному выражению для ? при произвольной E<0, и при правильной процедуре поиска нулей B на всей плоскости E+iG  должны найтись и дискретные стационарные уровни. Очевидно, что при этом одна из интересующих нас линий ImB(E,G)=0 совпадает с полуосью отрицательных действительных E и достатоно находить ее пересечения с линиями ReB(E,G)=0. 
30.	В программе реализовано два метода  решения уравнения B=0 на комплексной плоскости. Для начала полезно знакомиться с первым, как более наглядным и надежным. Он выполняется после вызова пункта "B_{N+1}(E+iG)" и нажатия кнопки с зеленым треугольником ниже соответствующего графического окна. При этом переменная E+iG пробегает шагами hE, hG по всей решетке внутренних точек некоторого прямоугольника на плоскости (E,G).  Соответствующим цветом изображаются границы четырех областей. 1-ReB>0,ImB>0, 2-ReB>0,ImB<0, 3-ReB<0,ImB>0, 4-ReB<0,ImB<0. Следовательно, линия ImB=0 лежит между границами областей 1-2 и, соответственно, 3-4, а линия ReB=0 проходит между границами областей 1-3 и 2-4. Места встречи всех четырех областей указывают положение искомых точек с точностью до размера прямоугльничка (hE,hG). В этих местах запускается алгоритм секущих, уточняющих дискретные значения En+iGn итерациями: ei+1=ei-Bi(ei-ei-1)/(Bi-Bi-1), где e=E+iG, e0 и e1–противоположные вершины трехцветного малого ромба. Их выбор не однозначен, но, по опыту, результат применения алгоритма секущих получается одинаковым. Найденные En+iGn складываются в таблицу, вызываемую на экран пунктом "En+iGn". Заметим, что hE,hG и границы большого прямоугольника заданы по умолчанию, и могут быть переопределены из контекстных меню, открываемых правой кнопкой мыши. 
31.	Важно, что этот общий метод находит дискретные значения и на полуоси отрицательных действительных энергий, если задать Gmax>0 и Emin=Umin. Поведение границ областей 1,2,3,4 по разные стороны этой оси является странным и не столь ясным, как при G<0 (почему?). В связи с этим, полезно по таблицам энергий и по виду волновых функций проверить совпадение найденных на оси состояний с обычными уровнями энергии в том же потенциале.
32.	Альтернативный метод поиска дискретных состояний при G<0 является более быстрым, поскольку для него предварительное сканирование проводится лишь по E при фиксированном малом отрицательном G. При этом, как можно понять из предыдущей полной картины, бегунок E последовательно и поочередно встречает линии ImB=0 и  ReB=0. Пары точек изменения знака ImB (либо ReB) считаются точками e0 и e1 запуска алгоритма секущих. Любой из этих стартов, в случае сходимости алгоритма секущих, находит лишь правильные точки B=0, как и в первом методе. Из-за сложного рельефа функции B(e) и большой дистанции  до искомой точки (неудачных значений e0, e1), второй метод может промахиваться (расходиться или циклить), и тогда итерации автоматически прерываются. Однако, несмотря на некоторые пропуски состояний, этот быстрый метод автоматически применяется, как только  выбирается пункт "Quasistationary" из меню "Model", либо переопределяется потенциал. В результате, на фоне потенциала соответствующим цветом рисуются горизонтальные линии En для найденных En+iGn, а сами комплексные числа складываются в таблицу, вызываемую пунктом "En+iGn". Если ранее было открыто окно с прямоугольником (E,G), то в нем эти точки автоматически располагаются со стиранием прежнего изображения. Полезно следить за изменением положения этих точек при изменении потенциала мышью.

На самом деле, дискретные квазистационарные состояния можно считать уширенными уровнями энергии с шириной, определяемой Gn. Соответствующее распределение по действительным энергиям частицы дается формулой Брейта-Вигнера: W(E)=1/(1+(E-En)2/G2). 
33.	Для удобства контуры Брейта-Вигнера можно нарисовать в окне T(E). По умолчанию рисуется найденное состояние с наименьшей En при G<0. Полезно расширять одну яму и видеть, как это состояние появляется при положительных En, но исчезает при малых отрицательных, но хвост распределения W(E) все еще виден при E>0. Интересно, что вид волновой функции квазистационарного состояния ?(x) почти не меняется, когда En  проходит через ноль. Состояние было и остается в обе стороны от нуля  распадным, что видно по квадрату модуля. Можно считать, что это "странное" поведение есть результат присутствия существенной части энергий из распределения Брейта-Вигнера в области E>0. 
34.	Если открыть окно волнового пакета в координатном представлении, то можно посмотреть за временной эволюцией одиночного квазистационарного состояния, либо их суперпозиции (то и другое заказывается по номерам n) через выбор соответствующего контекстного меню, нажатием правой кнопки мыши. Интересно смотреть не только квадрат модуля, но также эволюцию реальной части волновой функции. Интересно понять, что и почему произойдет с Re?(x,t), если En изменит знак при небольшом изменении потенциала.
35.	Просто и интересно выглядят квазистационарные состояния в случае, аналогичном резонансному туннелированию через пару или несколько одинаковых барьеров. 
36.	Прежнее определение в смысле отсутствия приходящих волн легко обобщается и сохраняется в силе для состояний на плоскости (E,G), отвечающих значениям E>maх(U(x<0),0), либо E<min(U(x<0),0). В первом случае имеется распад в обе стороны и квадрат модуля растет быстрее в сторону большего потенциала  (почему?). Во втором случае мы имеем дело с обычными уровнями, для которых ситуация с квадратом модуля противоположна. 
Вопрос о гранусловиях при поиске квазистационарных состояний не прост  в случае промежуточных энергий min(U(x<0),0)<E<maх(U(x<0),0). Глубоко внутри этой области энергий ширина квазистационарных дискретных уровней будет много меньше, чем maх(U(x<0),0)-En. Лишь малая доля частиц из распределения Брейта-Вигнера будет иметь действительную энергию выше, чем maх(U(x<0),0)-En. Поэтому кажется разумным формально запретить распад в  потенциальную ступень, поскольку по физике он вряд ли возможен при большой величине maх(U(x<0),0)-E. Например, так делается в случае потенциала с бесконечной стенкой, на которой ?=0, и распад идет в одну сторону. Тогда при конечной, но высокой ступени можно считать, что при G<0 "волна втягивается" из ступени, чтобы  затем уйти в том же направлении на другую бесконечность. Если при этом U(x<0)>0, то при x<0, волновая функция задается в виде приходящей волны exp(ik0x), k0=k0R+ik0I (k0R>0, k0I<0), т.е. ?(x)=exp(ik0Rx)exp(-k0Ix). На другой стороне однако вид волновой функции такой же, как раньше и поиск квазистационарных состояний это поиск нулей функции B(E+iG). Если, наоборот, U(x<0)<0 и E<0, то гранусловия меняются на противоположные. Из плюс бесконечности идет только приходящая волна Bexp(-ikRx)exp(kIx), но зато при x<0 волновая функция в задаче рассеяния при комплексной энергии имеет общий вид  A0exp(ik0Rx)exp(-k0Ix)+B0exp(-ik0Rx)exp(k0Ix). Следовательно, поиск дискретных квазистационарных состояний ведется по условию A0=0. К сожалению, трудно четко определить, какая ступень является достаточно высокой, чтобы менять гранусловия, как сказано в этом пункте. Поэтому мы меняли их просто по формальному условию попадания в окно энергий min(U(x<0),0)<E<maх(U(x<0),0). При этом для некоторых потенциалов будет потеряно состояние, которое только что опустилось под maх(U(x<0),0) и является распадным в обе стороны из-за конечной ширины распределения Брейта-Вигнера. Поскольку эти потери случаются редко и суть потерь ясна, в программе мы их не отслеживаем. Впрочем, на комплексной плоскости, при выполнении пункта 30 эти места можно заметить (но не исправить). 

====================
Для преподавателей--быстрый способ знакомства с программой.

1. Для удобства все данные в программе заданы по умолчанию, они соответствуют некоторым сравнительно простым физическим задачам по соответствующим темам. В главном меню "Model" стоят три взаимоисключающие альтернативы, из которых по умолчанию выбрана основная--"Bound states/Scattering". Напротив, выбор одного из пунктов меню  "Зависимости" ("Доп. зависимости") не исключает выбора других. Однако в программе по умолчанию выбран лишь 
основной пункт--"U(x)&En"--потенциал и дискретные уровни энергии. 

2. Можно сразу пройтись по возможностям программы, т.е. увидеть результат численного решения заранее предусмотренных физических задач без ручного задания параметров, а просто последовательно выбрав желаемый пункт из меню "Зависимости" ("Доп. зависимости"), если они имеют отношение к основной модели "Bound states/Scattering". При этом откроется дополнительное графическое окно и в нем нарисуются графики для потенциала, заданного по умолчанию. Иногда для рисования требуется нажать кнопку исполнения с обычным треугольным знаком "вперед" или приостановить длительный процесс повторным нажатием той же кнопки.

3. Выбрав другой пункт из меню "Model", можно, не меняя потенциала основной модели,  выбрать гранусловия для поиска квазистационарных состояний на комплексной плоскости энергий, отвечающие отсутствию приходящих волн, а также собрать волновой пакет из таких дискретных состояний. Еще один пункт позволяет периодически распространить заданный потенциал на отрезке (0,x_N) на всю действительную ось, найти зонный спектр стационарных состояний и собрать из состояний разрешенной зоны волновой пакет.

4. Меню "File" содержит пункты выхода из программы, чтения файла с ранее заготовленными 
данными (другими сост. программы), записи файла с текущими ценными данными (имя файла по обычному запросу задаете сами) и пункт краткого пояснения к программе kvant. Можно воспользоваться файлами данных на этапе первоначального знакомства с программой или для быстрых демонстраций на лекциях и семинарах без использования продвинутых возможностей 
интерактивного управления.
\end{document}
